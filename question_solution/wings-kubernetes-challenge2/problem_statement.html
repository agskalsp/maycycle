<p><strong>In this hands on you are going to work on kubernetes ConfigMaps, Secrets, Persistence Storage and&nbsp;Persistence Storage Claims&nbsp;</strong></p>

<p><span style="color:#c0392b;"><u><strong>Environment Setup</strong></u></span><br />
&nbsp;</p>

<p>Check whether docker &amp; minikube are properly installed and configured.</p>

<p>Start Minikube and execute this command to sync host docker with minikube docker `<strong><span style="color:#27ae60;"><em>minikube -p minikube docker-env</em></span></strong>` and `<span style="color:#27ae60;"><em><strong>eval $(minikube docker-env)</strong></em></span>`</p>

<p>&nbsp;</p>

<p><span style="color:#c0392b;"><strong>------------------------------------------------ ConfigMaps ------------------------------------------------</strong></span><br />
<u><strong>Step - 1</strong></u><br />
Create a ConfigMap named `fresco-config`.<br />
Add key `<strong>SERVER_URL</strong>`.<br />
Add value &nbsp;`<strong>https://www.fresco.me</strong>`.</p>

<p>Verify if the ConfigMap is created.</p>

<p><br />
<u><strong>Step - 2</strong></u><br />
Create an nginx pod with the environmental variable `<strong>SERVER_URL_ENV</strong>`.<br />
Use the ConfigMap created earlier, and assign the value to it. Use below template:</p>

<p>`<span style="color:#27ae60;"><em><strong>apiVersion: v1<br />
kind: Pod<br />
metadata:<br />
&nbsp; name: fresco-nginx-pod<br />
spec:<br />
&nbsp; containers:<br />
&nbsp; &nbsp; - name: fresco-nginx-container<br />
&nbsp; &nbsp; &nbsp; image: nginx<br />
&nbsp; &nbsp; &nbsp; env: fetch the value of SERVER_URL_ENV from previous configMap</strong></em></span>`</p>

<p><br />
Test your configuration by executing this command: <span style="color:#27ae60;"><em><strong>kubectl exec -it fresco-nginx-pod -- sh -c env | grep SERVER_URL_ENV</strong></em></span><br />
It should display: <strong>https://www.fresco.me</strong></p>

<p>&nbsp;</p>

<p><span style="color:#c0392b;"><strong>------------------------------------------------ Secrets</strong></span><span style="color:#c0392b;"><strong>&nbsp;------------------------------------------------</strong></span><br />
<u><strong>Step - 1</strong></u><br />
Create a Secret `<em><strong>fresco-secret</strong></em>` using:<br />
data:<br />
&nbsp;user:admin<br />
&nbsp;pass:pass</p>

<p>&nbsp;</p>

<p><u><strong>Step - 2</strong></u><br />
Modify the above nginx pod to add the <em><strong>fresco-secret</strong></em> and <strong><em>mountPath /etc/test</em></strong>:</p>

<p>Use this command to check if the pod and secret are successfully configured:&nbsp;<br />
<span style="color:#27ae60;"><em><strong>kubectl exec -it fresco-nginx-pod -- sh -c &quot;cat /etc/test/* | base64 -d</strong></em></span>&quot;<br />
It should display both username &amp; password</p>

<p><br />
<span style="color:#c0392b;"><strong>------------------------------------------------ Persistence Volume</strong></span><span style="color:#c0392b;"><strong>&nbsp;------------------------------------------------</strong></span><br />
Create a PV named `<em><strong>fresco-pv</strong></em>` using the following parameters:<br />
```<br />
<em>storageClassName - manual<br />
capacity - 100MB<br />
accessMode - ReadWriteOnce<br />
hostPath - /tmp/fresco</em><br />
```</p>

<p>Create a PVC named `<em><strong>fresco-pvc</strong></em>`, and request for 50MB.<br />
To verify successful creation, ensure it is bound to `<strong>fresco-pv</strong>`.</p>

<p><br />
Modify above nginx pod named `<strong>fresco-nginx-pod</strong>` using the following parameters:<br />
```<br />
Request for fresco-pvc as a volume<br />
Use <em>/usr/share/nginx/html</em> for mount path.<br />
```</p>

<p>**Hint:** Use `kubectl describe pod fresco-nginx-pod` for debugging.</p>

<p>&nbsp;</p>

<p><span style="color:#c0392b;"><strong>------------------------------------------------ RBAC</strong></span><span style="color:#c0392b;"><strong>&nbsp;------------------------------------------------</strong></span><br />
In this section, you will create a user `<strong><em>emp</em></strong>` and assign &#39;<strong><em>read</em></strong>&#39; rights on pods belonging to the namespace `<strong><em>dev</em></strong>`.</p>

<p>Create a namespace named `<em><strong>dev</strong></em>`.<br />
Use `<em><strong>openssl</strong></em>`, and create a private key named `<em><strong>emp.key</strong></em>`.</p>

<p>Create a certificate sign request named `<em><strong>emp.csr</strong></em>` using the private key generated earlier.<br />
Use the following information:<br />
```<br />
<em>name :emp<br />
group: dev</em><br />
```</p>

<p>Generate `<em><strong>emp.crt</strong></em>` by approving the request created earlier.<br />

<p>&nbsp;</p>

<p>Create a new context pointing to the cluster `minikube`, and name it `<em><strong>dev-ctx</strong></em>`. It should point to the namespace `<em><strong>dev</strong></em>`, and the user should be `<em><strong>emp</strong></em>`.</p>

<p>Set credentials for `<em><strong>emp</strong></em>`.<br />
Use `<em><strong>emp.key</strong></em>` and `<em><strong>emp.crt</strong></em>` created earlier.</p>

<p>&nbsp;</p>

<p>Create a role named `<em><strong>emp-role</strong></em>`, and assign `<em><strong>get</strong></em>`, `<em><strong>list</strong></em>` access on `<em><strong>pods</strong></em>` and `<em><strong>deployments</strong></em>`(use `<em><strong>dev</strong></em>` namespace).</p>

<p>Bind `<strong><em>emp</em></strong>` to the role `<em><strong>emp-role</strong></em>` created earlier, and name it `<em><strong>emp-bind</strong></em>`.</p>

<p>Run an `<em><strong>nginx</strong></em>` pod under the `<em><strong>dev-ctx</strong></em>` and `<em><strong>dev</strong></em>` namespace and `<em><strong>nginx</strong></em>` name.</p>

<p>&nbsp;</p>

<p>Execute `<em><strong>kubectl --context=dev-ctx get pods -o wide</strong></em>`, and ensure it is deployed.</p>

<p>If you try to execute `<em><strong>kubectl --context=dev-ctx get pods -n default</strong></em>`, a `forbidden` error appears. This is because only employees are authorized to access the `dev` namespace.</p>
